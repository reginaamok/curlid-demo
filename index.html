<script>
  // 1) Product + "why" list for each hair family
  const PRODUCT_RECS = {
    "Straight (1A‚Äì1C)": [
      {
        name: "Lightweight Volumizing Shampoo",
        why: "Straight hair can get oily/flat fast‚Äîlight formulas clean without weighing it down."
      },
      {
        name: "Dry Shampoo",
        why: "Absorbs oil at the roots to keep straight hair fresh between washes."
      },
      {
        name: "Heat Protectant Spray",
        why: "Straight hair is often heat-styled; protectant helps prevent damage and split ends."
      }
    ],
    "Wavy (2A‚Äì2C)": [
      {
        name: "Light Curl Cream / Wave Enhancer",
        why: "Defines waves and reduces frizz without making hair crunchy or heavy."
      },
      {
        name: "Leave-In Conditioner (lightweight)",
        why: "Adds moisture to fight frizz while keeping waves bouncy."
      },
      {
        name: "Microfiber Towel / Cotton T-Shirt",
        why: "Less friction than a regular towel, so you get less frizz and better wave clumps."
      }
    ],
    "Curly (3A‚Äì3C)": [
      {
        name: "Curl Defining Cream",
        why: "Curly hair needs definition + moisture to keep curls shaped and less frizzy."
      },
      {
        name: "Deep Conditioner / Hair Mask",
        why: "Curls dry out faster; deep conditioning helps softness, shine, and breakage control."
      },
      {
        name: "Gel (medium hold)",
        why: "Creates a light ‚Äòcast‚Äô that locks in curl shape and helps curls last longer."
      }
    ],
    "Coily (4A‚Äì4C)": [
      {
        name: "Rich Leave-In Conditioner",
        why: "Coily hair needs more moisture; leave-in helps prevent dryness and shrinkage frizz."
      },
      {
        name: "Hair Butter / Thick Cream",
        why: "Seals moisture and adds long-lasting softness for tighter curl patterns."
      },
      {
        name: "Oil (jojoba/castor) for sealing",
        why: "Helps lock moisture in and reduces breakage at the ends."
      }
    ]
  };

  // 2) Helper: map a curl subtype (like 2A or 4C) to a ‚Äúhair family‚Äù
  function hairFamilyFromType(type) {
    const t = (type || "").toUpperCase().trim();
    if (t.startsWith("1")) return "Straight (1A‚Äì1C)";
    if (t.startsWith("2")) return "Wavy (2A‚Äì2C)";
    if (t.startsWith("3")) return "Curly (3A‚Äì3C)";
    if (t.startsWith("4")) return "Coily (4A‚Äì4C)";
    return null;
  }

  // 3) Demo prediction (random) ‚Äî later you can swap this for real AI model output
  function demoPredictType() {
    const types = ["1A","1B","1C","2A","2B","2C","3A","3B","3C","4A","4B","4C"];
    const pick = types[Math.floor(Math.random() * types.length)];
    const confidence = Math.floor(Math.random() * 16) + 85; // 85‚Äì100%
    return { type: pick, confidence };
  }

  // 4) Render results + product reasons
  function analyze() {
    const fileInput = document.getElementById("photo");
    const resultEl = document.getElementById("result");

    if (!fileInput.files || fileInput.files.length === 0) {
      resultEl.innerHTML = "Please upload a photo first üôÇ";
      return;
    }

    // DEMO prediction
    const { type, confidence } = demoPredictType();
    const family = hairFamilyFromType(type);

    const products = PRODUCT_RECS[family] || [];

    // Build HTML
    let html = `
      <div style="text-align:left; max-width:520px; margin: 0 auto;">
        <div style="text-align:center;">
          <div style="font-size:20px; font-weight:700;">Your Hair Type: ${type}</div>
          <div style="margin-top:6px;">Confidence: ${confidence}%</div>
          <div style="margin-top:10px; font-weight:700;">Category: ${family}</div>
        </div>

        <hr style="margin:18px 0; opacity:.25;">

        <div style="font-weight:700; margin-bottom:8px;">Recommended Products (and why):</div>
        <ol style="padding-left:18px; margin:0;">
          ${products.map(p => `
            <li style="margin-bottom:10px;">
              <div style="font-weight:700;">${p.name}</div>
              <div style="opacity:.9; font-size:14px;">${p.why}</div>
            </li>
          `).join("")}
        </ol>

        <div style="margin-top:14px; font-size:13px; opacity:.85;">
          Tip: For best results, take the photo in bright natural light and show the full curl pattern.
        </div>
      </div>
    `;

    resultEl.innerHTML = html;
  }
</script>
